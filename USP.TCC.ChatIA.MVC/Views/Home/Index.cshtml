<div class="container text-center">
    <h1>Chat com IA</h1>
    <div class="chatbox" id="chatbox" style="background-color: #f4f4f4; padding: 10px; border: 1px solid #ccc; border-radius: 5px; min-height: 300px; max-height: 400px; overflow-y: auto;"></div>
    <div class="input-group mb-3">
        <input type="text" id="message" class="form-control" style="text-align: left" placeholder="Escreva sua dúvida aqui...">
        <button class="btn btn-primary btn-lg" id="send">Enviar</button>
    </div>
</div>

<script>
    var chatbox = document.getElementById("chatbox");
    var message = document.getElementById("message");
    var send = document.getElementById("send");

    send.addEventListener("click", function () {
        var userMessage = message.value;
        var userDiv = document.createElement("div");
        userDiv.className = "message user";
        userDiv.innerHTML = "<strong>Você:</strong> " + userMessage;
        chatbox.appendChild(userDiv);

        // Defina o JSON a ser enviado no corpo da solicitação POST
        var data = {
            Pergunta: userMessage,
            Options: {
                Temperature: 0.7
            }
        };
        message.value = "";
        fetch("api/chat/pergunta/", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify(data)
        })
            .then(function (response) {
                
                return response.text();
            })
            .then(function (botMessage
            ) {
                var txt = JSON.parse(botMessage);
                console.log(txt);
                var botDiv = document.createElement("div");
                botDiv.className = "message bot";
                botDiv.innerHTML = "<strong>IA:</strong> " + txt.resposta.replace(/\n/g, '<br>');;
                chatbox.appendChild(botDiv);

                chatbox.scrollTop = chatbox.scrollHeight;
            });
    });
</script>